# office client
#
# Install a full office client with centos 7.
install
text
cmdline
lang de_CH.UTF-8
keyboard us
timezone Europe/Zurich --isUtc
auth --useshadow --enablemd5
selinux --disabled
firewall --disabled
services --enabled=NetworkManager,sshd --disabled=postfix
eula --agreed
ignoredisk --only-use=sda

# Installation source?

bootloader --location=mbr
zerombr
clearpart --all --initlabel

# TBD: Partitions (root, swap..), File System (XFS / EXT4)
part swap --asprimary --fstype="swap" --size=1024
part /boot --fstype xfs --size=200
part pv.01 --size=1 --grow
volgroup rootvg01 pv.01
logvol / --fstype xfs --name=lv01 --vgname=rootvg01 --size=1 --grow

rootpw toor

# define default repository
repo --name=base --baseurl=http://linuxsoft.cern.ch/centos/7/os/x86_64/
url --url="http://linuxsoft.cern.ch/centos/7/os/x86_64/"

%packages 
@core
%end

%post
/usr/bin/yum update -y --skip-broken
/usr/bin/yum -y install ntp

# epel-release
/usr/bin/yum -y install epel-release
/usr/bin/rpm -Uvh https://download.fedoraproject.org/pub/epel/7/x86_64/e/epel-release-7-5.noarch.rpm

# install cinnamon DE
/usr/bin/sed -i -e "s/\]$/\]\npriority=5/g" /etc/yum.repos.d/epel.repo
/usr/bin/sed -i -e "s/enabled=1/enabled=0/g" /etc/yum.repos.d/epel.repo
/usr/bin/yum install --enablerepo=epel -y cinnamon*
/usr/bin/echo "exec /usr/bin/cinnamon-session" >> ~/.xinitrc

# install Virtualbox
/usr/bin/yum install kernel-devel kernel-headers dkms
/usr/bin/yum groupinstall "Development Tools"
/usr/bin/yum update -y
/usr/bin/wget http://download.virtualbox.org/virtualbox/debian/oracle_vbox.asc
/usr/bin/rpm --import oracle_vbox.asc
/usr/bin/wget http://download.virtualbox.org/virtualbox/rpm/el/virtualbox.repo -O /etc/yum.repos.d/virtualbox.repo
/usr/bin/yum install VirtualBox-4.1

/usr/bin/yum -y clean all
/usr/bin/systemctl enable ntpd.service
%end
